'\" t
.\" ** The above line should force tbl to be a preprocessor **
.\" Man page for modify_resolvconf
.\"
.\" Copyright (C), 2001
.\"
.\" You may distribute under the terms of the GNU General Public
.\" License as specified in the file COPYING that comes with the
.\" man_db distribution.
.\"
.\" Wed Apr  4 17:36:33 CEST 2001 Peter Poeml (poeml@suse.de)
.\" 
.TH modify_resolvconf 8 "Thu Mar 15 2001" "0.1" "modify_resolvconf"
.SH NAME
modify_resolvconf \- modify /etc/resolv.conf
.SH SYNOPSIS
.\" 
.\"                   The general command line
.\" 
.\" \fBmodify_resolvconf\fP
.\" .IR action
.\" .IR options
.\"                   Detailed Synopsis
.LP
\fBmodify_resolvconf\fP
.IR modify
.B \-s \fI<service>\fP \-p \fI<process>\fP \-f \fI<path to script>\fP \-t \fI<text>\fP\||\fI-\fP [ \-l \fI<list of search domains>\fP ] [ \-d \fI<domainname>\fP \||\ \-n \fI<list of nameservers>\fP ] [ \-o \|| \-a \fI<pathname of file>\fP ] [ \-e \fI<string>\fP ] [ \-v ] [ \-q ]
.\" 
.LP
\fBmodify_resolvconf\fP
.IR restore
.B \-s \fI<service>\fP [ \-e \fI<string>\fP ] [ \-o \fI<pathname of file>\fP ] [ \-k ] [ \-v ] [ \-q ]
.\" 
.LP
\fBmodify_resolvconf\fP
.IR check
.B [ \-v ] [ \-q ]
.\" 
.LP
\fBmodify_resolvconf\fP
.IR cleanup
.B [ \-v ] [ \-q ]
.\" 
.LP
\fBmodify_resolvconf\fP
.B \-h, \-\-help
.\" 
.\"                    DESCRIPTION
.\" 
.SH DESCRIPTION
.B modify_resolvconf
can be used by programs that have to change resolv.conf dynamically. It provides a means to do that in a consistent way accross the system. The idea is to
.TP
\- make a backup
that can be restored later. Therefore, a fixed naming scheme is used (see below).
.TP
\- add an informational header
to the new resolv.conf that informs the user (or other programs) who changed the file, why it was done how to avoid it in the future. This header is automatically created by
.B modify_resolvconf
and is therefore standardized. This again allows certain programs (e.g. YaST) to handle a temporary resolv.conf.
The presence of this header is also used by
.B modify_resolvconf
to recognize that resolv.conf is temporary or not.

.PP
The naming scheme used for backup copies is:

.B /etc/resolv.conf.saved.by.<service name>.<private extension>

where
.B service name
is one of e.g. dhclient, dhcpcd, pppd, ipppd, pcmcia, hotplug (these are the major candidates) and
.B
private extension
might optionally be used by the service itself for special reasons.

.br
This naming scheme allows restoring resolv.conf at boottime after a crash of the
system or at starttime of the service (after a crash of the service).

In SuSE's \fI/etc/rc.config\fP, there is a variable named \fBMODIFY_RESOLV_CONF_DYNAMICALLY\fP which can be used to allow/disallow dynamic changes to resolv.conf systemwide (this has to be honoured by the respecting programs of course).

.\"
.\"                ACTIONS
.\"
.SH ACTIONS
.TP
.B modify
write a new resolv.conf with the supplied data and create a backup of the old one.
.TP
.B restore
take a backup (if it exists) and rename it to \fI/etc/resolv.conf\fP, and remove all other backups of the given service (resolv.conf.saved.by.<service>*).
.TP
.B cleanup
remove all backups of resolv.conf.saved.by.* while trying to restore the original one.
.TP
.B check
return 0 if resolv.conf has not been modified dynamically and write a status message to stderr. If resolv.conf has been modified dynamically, it returns 1 and echoes the text contained in the Info: tag to stderr.
.\" 
.\"                    OPTIONS
.\" 
.SH OPTIONS
.TP
.B \-s, \-\-service \fI<service>
name of the service that requests the modification. This will used for the name of the backup, and it is put into the Modified_by tag of the info header (see example below).
.TP
.B \-p, \-\-process \fI<process>
name of the daemon (if applicable)
.TP
.B \-i, \-\-pid \fI<pid>
process ID of the daemon (if applicable)
.TP
.B \-f, \-\-script \fI<path to script>
some script located at \fI<path to script>\fP that might be used by the daemon to request the modification
.TP
.B \-t, \-\-text \fI<text>
a text that explains why the change was done and how to prevent it in the future. If \fI-\fP is given as \fI<text>\fP, the text is read from stdin.
.TP
.B \-l, \-\-searchlist \fI<list of search domains>
specifies a list of domains, separated by spaces and protected by quotes, to be written to resolv.conf as searchlist
.TP
.B \-d, \-\-domain \fI<domainname>
the domain to be used
.TP
.B \-n, \-\-nameservers \fI<list of nameservers>
the (space separated and quoted if necessary) list of nameservers to be used
.TP
.B \-e, \-\-extension \fI<string>
appends an additional extension to the backup filename (this can be used by a service to create more than one backup like for different ppp devices)
.TP
.B \-o, \-\-save_now \fI<pathname of file>
creates an additional backup with the specified filename
.TP
.B \-a, \-\-save_later \fI<pathname of file>
inserts an additional tag into the informational header specifying a filename to use for an additional backup to be done at restore time.
.TP
.B \-k, \-\-keep
if used with restore, --keep puts the current resolver data into the resolv.conf that is being restored.
.TP
.B \-v, \-\-verbose
be verbose
.TP
.B \-h, \-\-help
show synopsis
.\" 
.\"                    EXAMPLE
.\" 
.SH EXAMPLE
This is an example for the resolv.conf that 
.B modify_resolvconf 
would create:

### BEGIN INFO
.br
#
.br
# Modified_by:  dhcpcd
.br
# Backup:       /etc/resolv.conf.saved.by.dhclient
.br
# Process:      /sbin/dhcpcd
.br
# Process_id:   12345
.br
# Script:
.br
#
.br
# Info:         blabla
.br
#               ...
.br
#
.br
### END INFO
.br
search suse.de
.br
nameserver 10.10.0.1
.br
nameserver 10.10.0.2
.br

.LP
.\"
.\"                FILES
.\"
.SH FILES
.TP
.I /etc/resolv.conf
.\"
.\"                BUGS
.\"
.SH BUGS
.br
save_later does not work properly if restoring one resolv.conf out of a stack of backups.
.\"
.\"                SEE ALSO
.\"
.SH "SEE ALSO"
.BR resolv.conf (5)
.\"
.\"                AUTHOR
.\"
.SH AUTHOR
.br
Christian Zoz <zoz@suse.de>
.br
Manual page by Peter Poeml <poeml@suse.de>.
